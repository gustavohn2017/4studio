{% extends 'admin_panel/base.html' %}

{% block title %}Gerenciar Áudios - 4Studio Admin{% endblock %}

{% block content %}
<div class="admin-content">
    <!-- Action Bar -->
    <div class="action-bar">
        <div>
            <h3>Gerenciar Áudios</h3>
        </div>
        <div class="action-buttons">
            <a href="{% url 'admin_panel:audio_upload' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i>
                Novo Áudio
            </a>
        </div>
    </div>

    <!-- Filters -->
    <div class="filters-container">
        <h4>Filtros</h4>
        <form method="get" action="{% url 'admin_panel:audio_manager' %}">
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="category">Categoria</label>
                    <select name="category" id="category">
                        <option value="">Todas as categorias</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}" {% if selected_category|stringformat:"s" == category.id|stringformat:"s" %}selected{% endif %}>
                                {{ category.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-group">
                    <label for="voice_type">Tipo de Voz</label>
                    <select name="voice_type" id="voice_type">
                        <option value="">Todos os tipos</option>
                        {% for voice_type in voice_types %}
                            <option value="{{ voice_type.id }}" {% if selected_voice_type|stringformat:"s" == voice_type.id|stringformat:"s" %}selected{% endif %}>
                                {{ voice_type.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-group">
                    <label for="featured">Em Destaque</label>
                    <select name="featured" id="featured">
                        <option value="">Todos</option>
                        <option value="true" {% if selected_featured == "true" %}selected{% endif %}>Em destaque</option>
                        <option value="false" {% if selected_featured == "false" %}selected{% endif %}>Sem destaque</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="q">Pesquisar</label>
                    <input type="text" name="q" id="q" placeholder="Título ou descrição" value="{{ search_query|default:'' }}">
                </div>
            </div>
            <div class="filter-actions">
                {% if request.GET %}
                    <a href="{% url 'admin_panel:audio_manager' %}" class="btn btn-secondary">
                        <i class="fas fa-times"></i>
                        Limpar
                    </a>
                {% endif %}
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-filter"></i>
                    Filtrar
                </button>
            </div>
        </form>
    </div>

    <!-- Content -->
    {% if audio_samples %}
    <div class="content-card">
        <div class="content-card-header">
            <h3>Lista de Áudios</h3>
        </div>
        <div class="content-card-body">
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: separate; border-spacing: 0 12px;">
                    <thead>
                        <tr style="color: #9ca3af; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">
                            <th style="padding: 12px 16px; text-align: left;">Título</th>
                            <th style="padding: 12px 16px; text-align: left;">Categoria</th>
                            <th style="padding: 12px 16px; text-align: left;">Tipo de Voz</th>
                            <th style="padding: 12px 16px; text-align: center;">Destaque</th>
                            <th style="padding: 12px 16px; text-align: left;">Áudio</th>
                            <th style="padding: 12px 16px; text-align: left;">Data</th>
                            <th style="padding: 12px 16px; text-align: center;">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for audio in audio_samples %}
                            <tr style="background: rgba(0, 0, 0, 0.2); transition: all 0.2s;">
                                <td style="padding: 16px; border-top-left-radius: 12px; border-bottom-left-radius: 12px; font-weight: 600; color: white;">{{ audio.title }}</td>
                                <td style="padding: 16px; color: #d1d5db;">{{ audio.category }}</td>
                                <td style="padding: 16px; color: #d1d5db;">{{ audio.voice_type }}</td>
                                <td style="padding: 16px; text-align: center;">
                                    {% if audio.featured %}
                                        <span style="background: rgba(34, 197, 94, 0.15); color: #10b981; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; border: 1px solid rgba(34, 197, 94, 0.3);">SIM</span>
                                    {% else %}
                                        <span style="background: rgba(107, 114, 128, 0.15); color: #9ca3af; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; border: 1px solid rgba(107, 114, 128, 0.3);">NÃO</span>
                                    {% endif %}
                                </td>
                                <td style="padding: 16px;">
                                    <audio controls style="width: 250px; height: 36px;">
                                        <source src="{{ audio.audio_file.url }}" type="audio/mpeg">
                                    </audio>
                                </td>
                                <td style="padding: 16px; color: #9ca3af; font-size: 14px;">{{ audio.created_at|date:"d/m/Y" }}</td>
                                <td style="padding: 16px; text-align: center; border-top-right-radius: 12px; border-bottom-right-radius: 12px;">
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <a href="{% url 'admin_panel:audio_edit' audio.id %}" class="btn btn-secondary btn-icon-only" title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'admin_panel:audio_delete' audio.id %}" class="btn btn-secondary btn-icon-only" title="Excluir" style="border-color: rgba(239, 68, 68, 0.3); color: #ef4444;">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-state-icon">
            <i class="fas fa-microphone-slash"></i>
        </div>
        <h4>Nenhum áudio encontrado</h4>
        <p>{% if request.GET %}Nenhum resultado corresponde aos filtros aplicados. Tente ajustar os critérios de busca.{% else %}Você ainda não adicionou nenhum áudio. Comece criando seu primeiro áudio!{% endif %}</p>
        <a href="{% url 'admin_panel:audio_upload' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i>
            Adicionar Primeiro Áudio
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
